<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday ‚Äî For My Sister</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#ff6b6b; --accent2:#ffd93d; --glass:rgba(255,255,255,0.06);
      font-family:system-ui,-apple-system,'Segoe UI',Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body,html{height:100%;margin:0;background:linear-gradient(180deg,#081226 0%,#0f2a3b 100%);color:#f7fafc}
    .app{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:100%;max-width:980px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.08));border-radius:18px;padding:28px;position:relative;overflow:hidden;box-shadow:0 10px 40px rgba(2,6,23,0.6)}
    nav{position:absolute;right:18px;top:18px;display:flex;gap:8px;z-index:20}
    .nav-btn{background:var(--glass);border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;color:inherit;cursor:pointer;font-size:14px}
    .pages{position:relative;min-height:520px}
    .page{position:absolute;inset:0;padding:28px;opacity:0;transform:translateY(10px);pointer-events:none;transition:all 420ms cubic-bezier(.2,.9,.25,1)}
    .page.active{opacity:1;transform:none;pointer-events:auto}
    .greet{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}
    .btn{margin-top:20px;padding:12px 20px;border-radius:12px;background:linear-gradient(90deg,var(--accent),#ff8fab);border:none;color:#0b1220;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(255,107,107,0.16)}
    .photo-wrap{display:flex;gap:24px;align-items:center;flex-wrap:wrap;justify-content:center}
    .photo{width:320px;height:320px;border-radius:18px;background:linear-gradient(135deg,var(--accent2),#ffd0a6);display:flex;align-items:center;justify-content:center;overflow:hidden;border:6px solid rgba(255,255,255,0.04)}
    .photo img{width:100%;height:100%;object-fit:cover;display:block}
    .bigwish{font-size:28px;margin:0}
    .mem{font-weight:700;font-size:20px;margin-top:10px}

    /* typing: run ONCE then stop cursor */
    .typing{
      display:inline-block;
      white-space:normal;
      overflow:hidden;
      border-right:3px solid rgba(255,255,255,0.14);
      max-width:100%;
      animation: typing 6s steps(40,end) forwards, blink 700ms steps(40,end) 6; /* typing once, blink 6 times */
    }

    @keyframes typing{0%{max-width:0}50%{max-width:100%}100%{max-width:100%}}
    @keyframes blink{50%{border-color:transparent}}

    .balloon{position:absolute;width:48px;height:64px;border-radius:50% 50% 50% 50%/60% 60% 40% 40%;opacity:0.95}
    .balloon::after{content:'';position:absolute;left:50%;bottom:-18px;width:2px;height:24px;background:linear-gradient(180deg, rgba(255,255,255,0.2),transparent);transform:translateX(-50%)}
    .b1{left:10%;bottom:10%;background:linear-gradient(180deg,#ff9dbb,#ff6b6b);animation:float 9s ease-in-out infinite;animation-delay:0s}
    .b2{left:22%;bottom:6%;background:linear-gradient(180deg,#ffd36b,#ffb14b);animation:float 11s ease-in-out infinite;animation-delay:1s}
    .b3{right:18%;bottom:8%;background:linear-gradient(180deg,#9ad3ff,#66b3ff);animation:float 10s ease-in-out infinite;animation-delay:0.6s}
    .b4{right:6%;bottom:12%;background:linear-gradient(180deg,#c7a6ff,#8f6bff);animation:float 12s ease-in-out infinite;animation-delay:0.2s}
    @keyframes float{0%{transform:translateY(0) rotate(-4deg)}50%{transform:translateY(-18px) rotate(4deg)}100%{transform:translateY(0) rotate(-4deg)}}
    .rising-balloon{position:fixed;bottom:-160px;width:60px;height:80px;border-radius:50% 50% 50% 50%/60% 60% 40% 40%;display:flex;align-items:flex-end;justify-content:center;pointer-events:none;z-index:9999}
    .rising-balloon::after{content:'';position:absolute;left:50%;bottom:-28px;width:2px;height:30px;background:linear-gradient(180deg, rgba(255,255,255,0.2),transparent);transform:translateX(-50%)}
    @keyframes riseUp{0%{transform:translateY(0) rotate(0) scale(0.9);opacity:0}10%{opacity:1}100%{transform:translateY(-140vh) rotate(360deg) scale(1);opacity:1}}
    .cake-holder{position:fixed;left:50%;bottom:10%;transform:translateX(-50%) scale(0);transition:transform 650ms cubic-bezier(.2,.9,.25,1);z-index:10000}
    .cake-holder.show{transform:translateX(-50%) scale(1)}
    .cake-holder svg{width:220px;height:180px}
    .confetti{position:absolute;inset:0;pointer-events:none}
    .confetti span{position:absolute;width:10px;height:14px;opacity:0.95;transform-origin:center;animation:confetti-fall linear infinite}
    @keyframes confetti-fall{0%{transform:translateY(-20vh) rotate(0)}100%{transform:translateY(120vh) rotate(720deg)}}
    @media (max-width:700px){
      .photo{width:100%;height:340px}
      .card{padding:18px}
      nav{position:static;margin-bottom:8px;justify-content:center;gap:6px}
      .nav-btn{padding:6px 8px;font-size:13px}
      .mem{font-size:18px;text-align:center}
      .typing{font-size:16px;border-right-width:2px}
    }
    /* small music button style (unchanged) */
    #musicToggle{position:fixed;right:18px;bottom:18px;z-index:11000;padding:10px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,#ffd36b,#ff8fab);cursor:pointer;font-weight:700}
  </style>
</head>
<body>
  <div class="app">
    <div class="card" role="application">
      <nav>
        <button class="nav-btn" data-to="home">Home</button>
        <button class="nav-btn" data-to="photo">Photo</button>
        <button class="nav-btn" data-to="wish">Wish</button>
      </nav>

      <header><div><h1>For my sister ‚Äî with ‚ù§Ô∏è</h1></div></header>

      <div class="pages">
        <section id="home" class="page active">
          <div class="greet">
            <h2>Happy Birthdayyy to you üéâ</h2>
            <p class="subtitle">May your day be full of laughter, cake and lots of love.</p>
            <button class="btn" data-to="photo">Go to the next page ‚Üí</button>
          </div>
        </section>

        <section id="photo" class="page">
          <div class="photo-wrap">
            <div class="photo" aria-hidden="false">
              <img src="image.jpeg" alt="Photo of my sister (replace 'image.jpeg')"
                   onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 600 600%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23ffdede%22/><text x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22733%22 font-size=%2222%22>Replace image.jpeg with your photo</text></svg>'">
            </div>

            <div class="caption">
              <p class="bigwish">Happy Birthday ‚Äî <strong>you are loved</strong>!</p>
              <div style="height:12px"></div>
              <div class="caption-actions" style="display:flex;flex-direction:column;gap:14px;align-items:flex-start">
                <div class="small">A cake for you ‚Äî make a wish!</div>
                <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;justify-content:center">
                  <button class="btn" style="margin-top:0" id="celebrateBtnInline">Next ‚Äî see a memory ‚ú®</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section id="wish" class="page">
          <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%">
            <h2>Happy Birthday, Lovely!</h2>
            <p class="mem">‡ß®‡ß¶.‡ßß‡ß¶.‡ß®‡ß¶‡ß®‡ßß -- <span class="typing">
                "‡¶¶‡¶ø‡¶®‡¶ü‡¶æ ‡¶õ‡¶ø‡¶≤ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ ‡¶™‡ßÅ‡¶ú‡ßã, 
                ‡¶∏‡ßá‡¶¶‡¶ø‡¶®‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ò‡¶∞‡ßá ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ ‡¶è‡¶∏‡ßá‡¶õ‡¶ø‡¶≤‡•§" ü™îüíñ</span></p>
            <p style="opacity:0.9;max-width:640px;text-align:center;margin-top:14px">
              ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡ßá ‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ ‡¶ï‡¶∞‡¶ø‚Äî 
              ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶Ø‡¶§‡¶ü‡¶æ ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶Æ‡¶® ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ú‡¶®‡ßç‡¶Æ‡ßá‡¶õ‡ßã,
               ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ú‡ßÄ‡¶¨‡¶®‡¶ì ‡¶§‡¶§‡¶ü‡¶æ‡¶á ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶π‡ßã‡¶ï‡•§
            </p>
            <div style="height:18px"></div>
            <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;justify-content:center">
              <button class="btn" id="celebrateBtn">Celebrate üéâ</button>
              <button class="btn" data-to="home">Back to Home</button>
            </div>
          </div>
        </section>
      </div>

      <div class="balloon b1"></div>
      <div class="balloon b2"></div>
      <div class="balloon b3"></div>
      <div class="balloon b4"></div>

      <div id="cakeHolder" class="cake-holder" aria-hidden="true">
        <!-- cake SVG -->
        <svg viewBox="0 0 320 220" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g1" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#ffd7e0"/>
              <stop offset="100%" stop-color="#ffc2d0"/>
            </linearGradient>
            <linearGradient id="g2" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#fff7e6"/>
              <stop offset="100%" stop-color="#ffecc9"/>
            </linearGradient>
          </defs>
          <g transform="translate(10,10)">
            <rect x="40" y="20" rx="18" ry="18" width="240" height="60" fill="url(#g1)" stroke="#f1b0c0" stroke-width="4"/>
            <path d="M60 70 C75 58,95 82,120 70 C145 58,170 82,200 70 C230 58,260 78,280 70 L280 80 L60 80 Z" fill="#fff5f8" opacity="0.9"/>
            <rect x="20" y="80" rx="20" ry="20" width="280" height="80" fill="url(#g2)" stroke="#e6caa0" stroke-width="4"/>
            <ellipse cx="150" cy="175" rx="120" ry="18" fill="rgba(0,0,0,0.12)"/>
            <g>
              <rect x="80" y="50" width="6" height="2" rx="1" transform="rotate(-20 83 51)" fill="#ff6b6b"/>
              <rect x="110" y="48" width="6" height="2" rx="1" transform="rotate(12 113 49)" fill="#ffd36b"/>
              <rect x="150" y="52" width="6" height="2" rx="1" transform="rotate(-8 153 53)" fill="#9ad3ff"/>
              <rect x="190" y="50" width="6" height="2" rx="1" transform="rotate(18 193 51)" fill="#c7a6ff"/>
            </g>
            <g>
              <rect x="110" y="-6" width="8" height="34" rx="2" fill="#ffebc2"/>
              <rect x="140" y="-6" width="8" height="34" rx="2" fill="#ffebc2"/>
              <rect x="170" y="-6" width="8" height="34" rx="2" fill="#ffebc2"/>
            </g>
          </g>
        </svg>
      </div>

      <div id="rising" aria-hidden="true"></div>
      <div id="confetti" class="confetti" aria-hidden="true"></div>
    </div>
  </div>

  <!-- background music (place happy.mp3 in same folder) -->
  <audio id="bgMusic" loop preload="auto">
    <source src="happy.mp3" type="audio/mpeg">
    Your browser does not support HTML5 audio.
  </audio>

  <button id="musicToggle" aria-label="Play or pause music">‚ñ∂ Play music</button>

  <script>
    // basic navigation
    const pages = document.querySelectorAll('.page');
    function show(id){ pages.forEach(p=>p.classList.toggle('active', p.id===id)); history.replaceState(null,'','#'+id); }
    document.querySelectorAll('[data-to]').forEach(btn=>btn.addEventListener('click', e=>{ show(e.currentTarget.getAttribute('data-to')); }));
    const hash = location.hash.replace('#','') || 'home'; show(hash);

    // helpers & DOM refs
    const risingHolder = document.getElementById('rising');
    const cakeHolder = document.getElementById('cakeHolder');
    const confettiHolder = document.getElementById('confetti');
    const bgMusic = document.getElementById('bgMusic');
    const musicToggle = document.getElementById('musicToggle');

    function rand(min,max){ return Math.random()*(max-min)+min }

    // celebration state
    let celebrationRunning = false;
    let celebrationTimeoutId = null;

    function startConfettiAndBalloons(){
      // confetti
      confettiHolder.innerHTML = '';
      confettiHolder.setAttribute('aria-hidden','false');
      const colors = ['#ff6b6b','#ffd36b','#9ad3ff','#c7a6ff','#7ef0c3'];
      for(let i=0;i<60;i++){
        const s=document.createElement('span');
        const left=rand(0,100); const delay=rand(0,2);
        s.style.left = left+'vw'; s.style.top='-10vh';
        s.style.width = (rand(6,12))+'px'; s.style.height=(rand(8,16))+'px';
        s.style.background = colors[Math.floor(rand(0,colors.length))];
        s.style.borderRadius = (Math.random()>0.5?'2px':'50%');
        s.style.animationDuration = (rand(3.5,6))+'s';
        s.style.animationDelay = delay+'s';
        s.style.transform = 'rotate('+rand(0,360)+'deg)';
        confettiHolder.appendChild(s);
      }

      // rising balloons
      risingHolder.innerHTML = '';
      risingHolder.setAttribute('aria-hidden','false');
      const balloonCount = 10;
      for(let i=0;i<balloonCount;i++) createRisingBalloon(i);
    }

    function createRisingBalloon(i){
      const b=document.createElement('div'); b.className='rising-balloon';
      const size=rand(40,80); b.style.width=size+'px'; b.style.height=(size*1.2)+'px';
      b.style.left = rand(5,95)+'vw';
      const palette = ['linear-gradient(180deg,#ff9dbb,#ff6b6b)','linear-gradient(180deg,#ffd36b,#ffb14b)','linear-gradient(180deg,#9ad3ff,#66b3ff)','linear-gradient(180deg,#c7a6ff,#8f6bff)','linear-gradient(180deg,#7ef0c3,#34d399)'];
      b.style.background = palette[Math.floor(rand(0,palette.length))];
      const dur = rand(7,12); const delay = rand(0,2);
      b.style.animation = `riseUp ${dur}s linear ${delay}s forwards`;
      b.style.transition = 'transform 1s linear';
      risingHolder.appendChild(b);
      setTimeout(()=>{ b.style.opacity='0.95' }, delay*1000);
    }

    function stopCelebration(){
      // hide cake
      cakeHolder.classList.remove('show');
      cakeHolder.setAttribute('aria-hidden','true');

      // clear confetti & balloons
      confettiHolder.innerHTML = ''; confettiHolder.setAttribute('aria-hidden','true');
      risingHolder.innerHTML = ''; risingHolder.setAttribute('aria-hidden','true');

      // stop music if playing
      try{
        if(!bgMusic.paused){ bgMusic.pause(); bgMusic.currentTime = 0; musicToggle.innerText = '‚ñ∂ Play music'; }
      }catch(e){}

      celebrationRunning = false;
      if(celebrationTimeoutId){ clearTimeout(celebrationTimeoutId); celebrationTimeoutId = null; }
    }

    function startCelebrationFor20s(){
      if(celebrationRunning) return; // don't start again while running
      celebrationRunning = true;

      // show cake immediately
      cakeHolder.classList.add('show'); cakeHolder.setAttribute('aria-hidden','false');

      // start confetti and balloons immediately
      startConfettiAndBalloons();

      // try to play music (click gesture required in some browsers; if fails, ignore)
      try{ bgMusic.play().catch(()=>{}); musicToggle.innerText = '‚è∏ Pause music'; }catch(e){}

      // schedule stop after 20 seconds
      celebrationTimeoutId = setTimeout(()=>{ stopCelebration(); }, 20000);
    }

    // wire buttons
    const celebrateBtn = document.getElementById('celebrateBtn');
    const celebrateBtnInline = document.getElementById('celebrateBtnInline');
    if(celebrateBtn) celebrateBtn.addEventListener('click', ()=>{ startCelebrationFor20s(); });
    if(celebrateBtnInline) celebrateBtnInline.addEventListener('click', ()=>{ show('wish'); startCelebrationFor20s(); });

    // music toggle
    musicToggle.addEventListener('click', async ()=>{
      try{
        if(bgMusic.paused){ await bgMusic.play(); musicToggle.innerText = '‚è∏ Pause music'; }
        else { bgMusic.pause(); bgMusic.currentTime = 0; musicToggle.innerText = '‚ñ∂ Play music'; }
      }catch(e){ alert('Unable to play audio. Make sure happy.mp3 exists or try clicking Celebrate first.'); }
    });

    // stop cursor after typing + blinking finishes
    (function disableTypingCaretAfterFinish(){
      const typingEl = document.querySelector('.typing');
      if(!typingEl) return;
      // typing = 6s, blink 700ms * 6 = 4200ms, remove caret after ~10200ms
      const total = 6000 + (700 * 6);
      setTimeout(()=>{ typingEl.style.borderRight = 'none'; }, total + 50);
    })();

    // left/right navigation shortcuts (unchanged)
    window.addEventListener('keydown', e=>{
      const ids = Array.from(pages).map(p=>p.id);
      const current = ids.findIndex(id=>document.getElementById(id).classList.contains('active'));
      if(e.key==='ArrowRight') show(ids[(current+1)%ids.length]);
      if(e.key==='ArrowLeft') show(ids[(current-1+ids.length)%ids.length]);
    });
  </script>
</body>
</html>
